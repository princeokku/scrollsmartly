/*!
 scrollsmartly.js v0.1 
 Copyright (c) 2013 Shinnosuke Watanabe
 Licensed under the MIT License

 This library is originated from scrollsmoothly.js
 Copyright (c) 2008 KAZUMiX
 Licensed under the MIT License
*/
!function(a){a([],function(){"use strict";function a(){if(r.length>0){console.log(r);var a=r.shift();a()}}function b(){t=!0}function c(a){if(n.hashScrollSynced){var b=a||event,c=b.target||b.srcElement;void 0!==c.href&&-1!==c.href.indexOf("#")&&(console.log(c.href),f(!1))}}function d(){t===!0&&(h(),console.log("mutated"),void 0!==O&&(t=!1)),g(),n.easing<1&&(n.easing=1);var b=(w-z)/n.easing,c=(x-A)/n.easing;if(n.velocity=[b,c],B===z&&C===A||u){if(void 0!==O&&O.disconnect(),G(window,"scroll",L),u)return;return scrollTo(w,x),n.scrolledTo=v,u=!0,n.velocity=[0,0],s.length>0?n.scroll(s.shift()):(e(),n.scrollingTo=B=C=null,"function"==typeof m&&m(),a(),window.dispatchEvent(S)),void 0}B=z,C=A,scrollTo(Z(z+b),Z(A+c)),W=setTimeout(function(){d()},p)}function e(){!n.scrollHashSynced||y===location.hash.substring(1)||r.length>0||(""!==y?(f(!1),void 0!==history.pushState?history.pushState("",document.title,location.pathname+"#"+y):i()||0!==n.marginLeft||0!==n.marginTop?(v.id="",location.hash="#"+y,v.id=y):location.hash="#"+y):""!==location.hash&&void 0!==history.pushState&&(f(!1),history.pushState("",document.title,location.pathname)))}function f(a){n.scrollHashSynced&&(a?clearTimeout(X):(I=!1,X=setTimeout(function(){I=!0},30)))}function g(){z=document.documentElement.scrollLeft||document.body.scrollLeft,A=document.documentElement.scrollTop||document.body.scrollTop,n.currentLeft=z,n.currentTop=A}function h(){for(var a=0,b=0,c=v;c;){if(void 0!==c.offsetLeft)a+=c.offsetLeft,b+=c.offsetTop;else{var d=c.getBoundingClientRect();a+=d.left,b+=d.top}c=c.offsetParent}var e=Y(),f=j();w=Math.min(a+f.x,e.x),0>w&&(w=0),x=Math.min(b+f.y,e.y),0>x&&(x=0)}function i(){return n.position&&"left top"!==n.position}function j(){var a=0,b=0;if(i()){var c=String(n.position).split(" ");1===c.length&&(c[1]=c[0]);var d,e;if(void 0!==v.offsetWidth)d=v.offsetWidth,e=v.offsetHeight;else{var f=v.getBoundingClientRect();d=f.width,e=f.height}var g;g=k(c[0]),a=parseInt((E-d)*g,10),g=k(c[1]),b=parseInt((F-e)*g,10)}return{x:-(a+n.marginLeft),y:-(b+n.marginTop)}}function k(a){return"left"===a||"top"===a?0:"center"===a?.5:"right"===a||"bottom"===a?1:"%"===a.charAt(a.length-1)?.01*parseFloat(a):0}function l(a,b){if(void 0!==a){var c;c=void 0===a.length?[a]:a;for(var d=0;d<c.length;d++)b.call(n,c[d],d)}}var m,n={},o=location.href.split("#")[0],p=15,q=!0,r=[],s=[],t=null,u=!0;n.set=function(){switch(arguments.length){case 1:if("object"==typeof arguments[0])for(var b in arguments[0])n.hasOwnProperty(b)&&(n[b]=arguments[0][b]);break;case 2:n.hasOwnProperty(arguments[0])&&(n[arguments[0]]=arguments[1])}return a(),n},n.delay=function(){function a(a,e){return function(){var f=arguments,g=function(){setTimeout(function(){"function"==typeof b&&b.apply(this,d),a.apply(n,f)},e)};return null!==n.scrollingTo?r[r.length]=g:g(),-1!==c?n:n.delay(-1)}}var b,c=0,d=[];switch(arguments.length){case 0:break;case 1:"function"==typeof arguments[0]?b=arguments[0]:c=arguments[0];break;case 2:b=arguments[0],c=arguments[1];break;default:b=arguments[0],c=arguments[1];for(var e=2;e<arguments.length;e++)d[e-2]=arguments[e]}var f={};for(var g in n)f[g]="function"==typeof n[g]&&"delay"!==g?a(n[g],c):n[g];return f},n.easing=5,n.scrollingTo=null,n.scrolledTo=null,n.hashScrollSynced=!0,n.scrollHashSynced=!0,n.currentLeft=0,n.currentTop=0,n.position="left top",n.marginLeft=0,n.marginTop=0,n.velocity=[0,0];var v,w=0,x=0,y="",z=0,A=0,B=null,C=null,D=document.documentElement||document.body;n.homeElement=D;var E=0,F=0;""===location.hash&&-1!==location.href.indexOf("#")&&void 0!==history.replaceState&&history.replaceState("",document.title,location.pathname);var G,H;void 0!==window.addEventListener?(G=function(a,b,c){a.addEventListener(b,c,!1)},H=function(a,b,c){a.removeEventListener(b,c,!1)}):"attachEvent"in window&&(G=function(a,b,c){a.attachEvent("on"+b,c)},H=function(a,b,c){a.detachEvent("on"+b,c)});var I=!0,J=function(){I&&n.hashScrollSynced&&(scrollTo(z,A),n.scroll(location.hash.substring(1)))},K=null,L=function(){g()},M=null,N=function(){null!==M&&clearTimeout(K),M=setTimeout(function(){b()},50)};MutationObserver=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver||!1;var O;MutationObserver?O=new MutationObserver(function(){b()}):t=!0;var P,Q,R,S,T=function(a){a?(P=function(a){a.preventDefault(),a.stopPropagation(),void 0!==this.scrollSmartlyTarget?n.scroll(this.scrollSmartlyTarget):n.scroll(this.hash.substring(1))},Q=function(a){var b=document.createEvent("HTMLEvents");return b.initEvent(a,!1,!1),this["on"+a]=null,G(window,a,function(b){"function"==typeof this["on"+a]&&this["on"+a](b)}),b}):"event"in window&&(P=function(){var a=event.srcElement||event.target;event.returnValue=!1,event.cancelBubble=!0,n.scroll(a.hash.substring(1))},Q=function(a){var b=document.createEvent("HTMLEvents");return b.initEvent(a,!1,!1),this["on"+a]=null,G(window,a,function(){var b=event;"function"==typeof this["on"+a]?this["on"+a](b):null!==this["on"+a]&&console.log("on"+a+":",this["on"+a])}),b}),R=Q("smartlystart"),S=Q("smartlyend"),G(window,"hashchange",J),G(window,"scroll",L),G(window,"resize",N),T=function(){}};G(document,"DOMContentLoaded",function(a){T(a)}),G(window,"load",function(a){T(a),g(),_(),!n.hashScrollSynced||""===location.hash&&n.homeElement===D||(void 0!==window.attachEvent&&void 0===window.opera?setTimeout(function(){scrollTo(0,0),n.scroll(location.hash.substring(1)||n.homeElement)},30):(scrollTo(0,0),n.scroll(location.hash.substring(1)||n.homeElement))),G(document.body,"click",c),q=!1});var U;if(void 0!==Array.isArray)U=Array.isArray;else{var V=Object.prototype.toString.call;U=function(a){return"[object Array]"===V(a)}}n.scroll=function(){var a=[""],b=null;switch(arguments.length){case 0:break;case 1:"object"==typeof arguments[0]?(1===arguments[0].nodeType?a[0]=arguments[0]:void 0!==arguments[0].via?(a=U(arguments[0].via)?arguments[0].via:[arguments[0].via],void 0!==arguments[0].to&&a.push(arguments[0].to)):a[0]=arguments[0].to,void 0!==arguments[0].callback&&(b=arguments[0].callback)):"function"!=typeof arguments[0]?a[0]=arguments[0]:b=arguments[0];break;case 2:"function"==typeof arguments[1]?(a[0]=arguments[0],b=arguments[1]):(a[0]=arguments[0],a[1]=arguments[1]);break;default:for(var c=arguments.length-1,e=0;c>e;e++)a[e]=arguments[e];"function"==typeof arguments[c]?b=arguments[c]:a[c]=arguments[c]}var g=a.shift();return 1===g.nodeType?(v=g,y=g.id):"string"==typeof g&&(v=""!==g?document.getElementById(g):n.homeElement?n.homeElement:D,y=g),null===v?n:(a.length>0&&(s=a),h(),void 0!==O&&O.observe(document.body,{attributes:!0,subtree:!0,characterData:!1}),null!==n.scrollingTo&&u?n.scrollingTo=v:(n.scrollingTo=v,b=b||null,clearTimeout(W),window.dispatchEvent(R)),H(window,"scroll",L),f(!0),u=!1,d(),n)};{var W,X,Y,Z=Math.round;Math.abs}if(void 0!==window.scrollMaxX)Y=function(){return{x:window.scrollMaxX,y:window.scrollMaxY}};else{Y=function(){var a=$();return _(),{x:a.width-E,y:a.height-F}};var $=function(){return{width:Math.max(document.body.scrollWidth,document.documentElement.scrollWidth),height:Math.max(document.body.scrollHeight,document.documentElement.scrollHeight)}}}var _;if(void 0!==D.clientWidth)_=function(){E=D.clientWidth,F=D.clientHeight};else if(window.innerWidth){var ab=document.createElement("div");ab.style.position="absolute",ab.style.left=ab.style.top="0",ab.style.width=ab.style.height="100%",ab.style.margin=ab.style.padding="0",ab.style.border="none",ab.style.visibility="hidden",_=function(){document.body.appendChild(ab),E=ab.offsetWidth,F=ab.offsetHeight,document.body.removeChild(ab)}}return n.stop=function(){return u=!0,s=[],n.scrollingTo=null,a(),n},n.finish=function(){return r=[],n.stop(),n},n.on=function(b,c){return l(b,function(a){a.scrollSmartlyTarget=void 0!==c?c:"",G(a,"click",P),a.style.cursor="pointer"}),a(),n},n.off=function(b){return l(b,function(a){delete a.scrollSmartlyTarget,H(a,"click",P),a.style.cursor=""}),a(),n},n.replaceAnchor=function(b,c){var d=b.href+"",e=d.lastIndexOf("#");return d.substring(0,e)===o&&(void 0!==b.hash&&(b.hash=d.substring(e+1)),delete b.scrollSmartlyTarget,G(b,"click",P)),c!==!0?(a(),n):void 0},n.all=function(){if(q)return G(window,"load",function(){q=!1,n.all()}),a(),n;for(var b=document.links,c=0;c<b.length;c++)n.replaceAnchor(b[c],!0);return a(),n},n})}("undefined"!=typeof define?define:"undefined"!=typeof module?function(a,b){module.exports=b()}:function(a,b){this.smartly=b()});
/*!
 scrollsmartly.js v0.1
 Copyright (c) 2013 - 2014 Shinnosuke Watanabe | MIT License

 This library is originated from scrollsmoothly.js
 Copyright (c) 2008 KAZUMiX | MIT License
 http://d.hatena.ne.jp/KAZUMiX/20080418/scrollsmoothly
*/
!function(a,b,c,d,e){"use strict";function f(){if(w.length>0){console.log(w);var a=w.shift();a()}}function g(){y=!0}function h(a){if(s.hashScrollSynced){var b=a||event,c=b.target||b.srcElement;c.href!==e&&-1!==c.href.indexOf("#")&&(console.log(c.href),k(!1))}}function i(){y===!0&&(m(),console.log("mutated"),T!==e&&(y=!1)),l(),s.easing<1&&(s.easing=1);var b=(B-E)/s.easing,c=(C-F)/s.easing;if(s.velocity=[b,c],G===E&&H===F||z){if(T!==e&&T.disconnect(),L(a,"scroll",Q),z)return;return scrollTo(B,C),s.scrolledTo=A,z=!0,s.velocity=[0,0],x.length>0?s.scroll(x.shift()):(j(),s.scrollingTo=G=H=null,"function"==typeof r&&r(),f(),a.dispatchEvent(X)),void 0}G=E,H=F,scrollTo(cb(E+b),cb(F+c)),_=setTimeout(function(){i()},u)}function j(){!s.scrollHashSynced||D===c.hash.substring(1)||w.length>0||(""!==D?(k(!1),d.pushState!==e?d.pushState("",b.title,c.pathname+"#"+D):n()||0!==s.marginLeft||0!==s.marginTop?(A.id="",c.hash="#"+D,A.id=D):c.hash="#"+D):""!==c.hash&&d.pushState!==e&&(k(!1),d.pushState("",b.title,c.pathname)))}function k(a){s.scrollHashSynced&&(a?clearTimeout(ab):(N=!1,ab=setTimeout(function(){N=!0},30)))}function l(){E=b.documentElement.scrollLeft||b.body.scrollLeft,F=b.documentElement.scrollTop||b.body.scrollTop,s.currentLeft=E,s.currentTop=F}function m(){for(var a=0,b=0,c=A;c;){if(c.offsetLeft!==e)a+=c.offsetLeft,b+=c.offsetTop;else{var d=c.getBoundingClientRect();a+=d.left,b+=d.top}c=c.offsetParent}var f=bb(),g=o();B=Math.min(a+g.x,f.x),0>B&&(B=0),C=Math.min(b+g.y,f.y),0>C&&(C=0)}function n(){return s.position&&"left top"!==s.position}function o(){var a=0,b=0;if(n()){var c=String(s.position).split(" ");1===c.length&&(c[1]=c[0]);var d,f;if(A.offsetWidth!==e)d=A.offsetWidth,f=A.offsetHeight;else{var g=A.getBoundingClientRect();d=g.width,f=g.height}var h;h=p(c[0]),a=parseInt((J-d)*h,10),h=p(c[1]),b=parseInt((K-f)*h,10)}return{x:-(a+s.marginLeft),y:-(b+s.marginTop)}}function p(a){return"left"===a||"top"===a?0:"center"===a?.5:"right"===a||"bottom"===a?1:"%"===a.charAt(a.length-1)?.01*parseFloat(a):0}function q(a,b){if(a!==e){var c;c=a.length===e?[a]:a;for(var d=0;d<c.length;d++)b.call(s,c[d],d)}}var r,s={},t=c.href.split("#")[0],u=15,v=!0,w=[],x=[],y=null,z=!0;s.set=function(){switch(arguments.length){case 1:if("object"==typeof arguments[0])for(var a in arguments[0])s.hasOwnProperty(a)&&(s[a]=arguments[0][a]);break;case 2:s.hasOwnProperty(arguments[0])&&(s[arguments[0]]=arguments[1])}return f(),s},s.delay=function(){function a(a,e){return function(){var f=arguments,g=function(){setTimeout(function(){"function"==typeof b&&b.apply(this,d),a.apply(s,f)},e)};return null!==s.scrollingTo?w[w.length]=g:g(),-1!==c?s:s.delay(-1)}}var b,c=0,d=[];switch(arguments.length){case 0:break;case 1:"function"==typeof arguments[0]?b=arguments[0]:c=arguments[0];break;case 2:b=arguments[0],c=arguments[1];break;default:b=arguments[0],c=arguments[1];for(var e=2;e<arguments.length;e++)d[e-2]=arguments[e]}var f={};for(var g in s)f[g]="function"==typeof s[g]&&"delay"!==g?a(s[g],c):s[g];return f},s.easing=5,s.scrollingTo=null,s.scrolledTo=null,s.hashScrollSynced=!0,s.scrollHashSynced=!0,s.currentLeft=0,s.currentTop=0,s.position="left top",s.marginLeft=0,s.marginTop=0,s.velocity=[0,0];var A,B=0,C=0,D="",E=0,F=0,G=null,H=null,I=b.documentElement||b.body;s.homeElement=I;var J=0,K=0;""===c.hash&&-1!==c.href.indexOf("#")&&d.replaceState!==e&&d.replaceState("",b.title,c.pathname);var L,M;a.addEventListener!==e?(L=function(a,b,c){a.addEventListener(b,c,!1)},M=function(a,b,c){a.removeEventListener(b,c,!1)}):"attachEvent"in a&&(L=function(a,b,c){a.attachEvent("on"+b,c)},M=function(a,b,c){a.detachEvent("on"+b,c)});var N=!0,O=function(){N&&s.hashScrollSynced&&(scrollTo(E,F),s.scroll(c.hash.substring(1)))},P=null,Q=function(){l()},R=null,S=function(){null!==R&&clearTimeout(P),R=setTimeout(function(){g()},50)};MutationObserver=a.MutationObserver||a.WebKitMutationObserver||a.MozMutationObserver||!1;var T;MutationObserver?T=new MutationObserver(function(){g()}):y=!0;var U,V,W,X,Y=function(c){c?(U=function(a){a.preventDefault(),a.stopPropagation(),this.scrollSmartlyTarget!==e?s.scroll(this.scrollSmartlyTarget):s.scroll(this.hash.substring(1))},V=function(c){var d=b.createEvent("HTMLEvents");return d.initEvent(c,!1,!1),this["on"+c]=null,L(a,c,function(a){"function"==typeof this["on"+c]&&this["on"+c](a)}),d}):"event"in a&&(U=function(){var a=event.srcElement||event.target;event.returnValue=!1,event.cancelBubble=!0,s.scroll(a.hash.substring(1))},V=function(c){var d=b.createEvent("HTMLEvents");return d.initEvent(c,!1,!1),this["on"+c]=null,L(a,c,function(){var a=event;"function"==typeof this["on"+c]?this["on"+c](a):null!==this["on"+c]&&console.log("on"+c+":",this["on"+c])}),d}),W=V("smartlystart"),X=V("smartlyend"),L(a,"hashchange",O),L(a,"scroll",Q),L(a,"resize",S),Y=function(){}};L(b,"DOMContentLoaded",function(a){Y(a)}),L(a,"load",function(d){Y(d),l(),eb(),!s.hashScrollSynced||""===c.hash&&s.homeElement===I||(a.attachEvent!==e&&a.opera===e?setTimeout(function(){scrollTo(0,0),s.scroll(c.hash.substring(1)||s.homeElement)},30):(scrollTo(0,0),s.scroll(c.hash.substring(1)||s.homeElement))),L(b.body,"click",h),v=!1});var Z;if(Array.isArray!==e)Z=Array.isArray;else{var $=Object.prototype.toString.call;Z=function(a){return"[object Array]"===$(a)}}s.scroll=function(){var c=[""],d=null;switch(arguments.length){case 0:break;case 1:"object"==typeof arguments[0]?(1===arguments[0].nodeType?c[0]=arguments[0]:arguments[0].via!==e?(c=Z(arguments[0].via)?arguments[0].via:[arguments[0].via],arguments[0].to!==e&&c.push(arguments[0].to)):c[0]=arguments[0].to,arguments[0].callback!==e&&(d=arguments[0].callback)):"function"!=typeof arguments[0]?c[0]=arguments[0]:d=arguments[0];break;case 2:"function"==typeof arguments[1]?(c[0]=arguments[0],d=arguments[1]):(c[0]=arguments[0],c[1]=arguments[1]);break;default:for(var f=arguments.length-1,g=0;f>g;g++)c[g]=arguments[g];"function"==typeof arguments[f]?d=arguments[f]:c[f]=arguments[f]}var h=c.shift();return 1===h.nodeType?(A=h,D=h.id):"string"==typeof h&&(A=""!==h?b.getElementById(h):s.homeElement?s.homeElement:I,D=h),null===A?s:(c.length>0&&(x=c),m(),T!==e&&T.observe(b.body,{attributes:!0,subtree:!0,characterData:!1}),null!==s.scrollingTo&&z?s.scrollingTo=A:(s.scrollingTo=A,d=d||null,clearTimeout(_),a.dispatchEvent(W)),M(a,"scroll",Q),k(!0),z=!1,i(),s)};{var _,ab,bb,cb=Math.round;Math.abs}if(a.scrollMaxX!==e)bb=function(){return{x:a.scrollMaxX,y:a.scrollMaxY}};else{bb=function(){var a=db();return eb(),{x:a.width-J,y:a.height-K}};var db=function(){return{width:Math.max(b.body.scrollWidth,b.documentElement.scrollWidth),height:Math.max(b.body.scrollHeight,b.documentElement.scrollHeight)}}}var eb;if(I.clientWidth!==e)eb=function(){J=I.clientWidth,K=I.clientHeight};else if(a.innerWidth){var fb=b.createElement("div");fb.style.position="absolute",fb.style.left=fb.style.top="0",fb.style.width=fb.style.height="100%",fb.style.margin=fb.style.padding="0",fb.style.border="none",fb.style.visibility="hidden",eb=function(){b.body.appendChild(fb),J=fb.offsetWidth,K=fb.offsetHeight,b.body.removeChild(fb)}}s.stop=function(){return z=!0,x=[],s.scrollingTo=null,f(),s},s.finish=function(){return w=[],s.stop(),s},s.on=function(a,b){return q(a,function(a){a.scrollSmartlyTarget=b!==e?b:"",L(a,"click",U),a.style.cursor="pointer"}),f(),s},s.off=function(a){return q(a,function(a){delete a.scrollSmartlyTarget,M(a,"click",U),a.style.cursor=""}),f(),s},s.replaceAnchor=function(a,b){var c=a.href+"",d=c.lastIndexOf("#");return c.substring(0,d)===t&&(a.hash!==e&&(a.hash=c.substring(d+1)),delete a.scrollSmartlyTarget,L(a,"click",U)),b!==!0?(f(),s):void 0},s.all=function(){if(v)return L(a,"load",function(){v=!1,s.all()}),f(),s;for(var c=b.links,d=0;d<c.length;d++)s.replaceAnchor(c[d],!0);return f(),s},a.smartly=s,"function"==typeof define&&"object"==typeof define.amd&&define.amd?define("scrollsmartly",[],function(){return s}):module!==e&&module.exports&&((module.exports=s).smartly=s)}(window,document,location,history);